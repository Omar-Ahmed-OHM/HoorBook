(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{3414:(e,t,s)=>{Promise.resolve().then(s.bind(s,623))},623:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var n=s(5155),r=s(8068),i=s(2115),a=s(7594),l=s(9678),o=s(8173),c=s.n(o),d=s(7351),m=s(8819),p=s(9208),u=s(5037),g=s(6046),x=s(22),h=s(7684),f=s(2651),_=s(8259),y=s(767);function w(e){let{show:t,onClose:s,setErrorModal:r}=e,l=(0,i.useRef)(null),[o,c]=(0,i.useState)({email:""}),m=(0,g.useRouter)();(0,i.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&s()};return t&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t]);let x=async e=>{e.preventDefault();let t=new FormData;t.append("email",o.email);try{let e=await f.A.post("".concat(d.B,"api/user/forget-password"),t,{headers:{"Content-Type":"multipart/form-data"}});!0==e.data.status.status?(u.Ay.success("تم إرسال رمز إعادة تعيين كلمة المرور إلى بريدك الإلكتروني."),c({email:""}),p.A.set("reset_pass_email",o.email),m.push("/verificationCode"),s()):(s(),u.Ay.error("حدث خطأ أثناء إرسال الطلب."),c({email:""}),r({message:"هذا الايميل غير موجود!",show:!0}))}catch(e){console.error("Error sending password reset request:",e)}};return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{ref:l,className:"bg-white p-6 rounded-xl w-full max-w-sm shadow-lg",children:[(0,n.jsx)(y.A,{className:"text-black cursor-pointer",onClick:()=>s()}),(0,n.jsx)("h2",{className:"text-xl font-bold mb-2 text-center text-black",children:"نسيت كلمة السر؟"}),(0,n.jsx)("p",{className:"text-center mb-4 text-gray-600",children:"أدخل عنوان بريدك الإلكتروني وسنرسل رمزًا لإنشاء كلمة مرور جديدة"}),(0,n.jsxs)("form",{onSubmit:x,children:[(0,n.jsx)(a.A,{fields:[{placeholder:"ادخل بريدك الالكتروني",name:"email",type:"email",requierd:!0}],data:o,onChange:c}),(0,n.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-purple-900 to-orange-400 text-white w-full py-2 rounded-lg hover:opacity-90 transition duration-300 flex items-center justify-center shadow-lg",children:"استمرار"})]})]})}):null}function b(){let[e,t]=(0,i.useState)({}),[s,o]=(0,i.useState)(!1),[y,b]=(0,i.useState)({show:!1,message:""});(0,g.useRouter)();let j="".concat(d.B,"api/user/login"),A=async t=>{t.preventDefault();try{let{access_token:t,user:s,token_type:n}=(await (0,m.YN)(j,e)).data;p.A.set("access_token_login",t,{expires:1}),p.A.set("token_type_login",n),p.A.set("login_user_id",s.id.toString()),p.A.set("login_user_name",s.name),p.A.set("login_user_email",s.email),p.A.set("login_user_type",s.type.toString()),p.A.set("login_user_type_name",s.type_name),p.A.set("login_cart_count",s.CartCount.toString()),u.Ay.success("تم تسجيل الدخول بنجاح \uD83C\uDF89"),window.window.location.href="/",s.pointsSettings&&(p.A.set("login_points",s.pointsSettings.points),p.A.set("login_price",s.pointsSettings.price),p.A.set("login_point_price",s.pointsSettings.point_price))}catch(e){u.Ay.error("فشل الدخول يرجى اعاده المحاوله ")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.A,{}),(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-orange-50 flex items-center justify-center px-4",children:(0,n.jsxs)(r.A,{children:[(0,n.jsxs)("form",{onSubmit:A,className:"bg-white rounded-2xl shadow-lg p-8 w-full max-w-md space-y-6",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center text-center space-y-2",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold text-purple-800",children:"مرحبًا بعودتك"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"سجّل دخولك للوصول إلى حسابك"})]}),(0,n.jsx)(a.A,{fields:[{label:"البريد الإلكتروني",name:"email",type:"email",requierd:!0},{label:"كلمة المرور",name:"password",type:"password",requierd:!0}],data:e,onChange:t}),(0,n.jsx)(_.$,{className:"text-sm text-purple-900 font-bold hover:underline mt-3 block",onClick:()=>o(!0),children:"هل نسيت كلمة المرور؟"}),(0,n.jsx)("button",{type:"submit",className:"w-full mt-2 bg-gradient-to-r from-purple-700 to-orange-400 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition",children:"تسجيل الدخول"}),(0,n.jsxs)("div",{className:"relative flex items-center justify-center text-gray-400",children:[(0,n.jsx)("div",{className:"absolute left-0 right-0 h-px bg-gray-200"}),(0,n.jsx)("span",{className:"bg-white px-3 z-10 text-sm",children:"أو"})]}),(0,n.jsx)("div",{className:"w-full flex justify-center mt-2",children:(0,n.jsx)(x.j,{onSuccess:async e=>{var t,s,n;try{if(!e.credential){u.Ay.error("لم يتم استلام بيانات الاعتماد من جوجل");return}let s=(0,h.s)(e.credential),n=new FormData;n.append("name","".concat(s.given_name," ").concat(s.family_name)),n.append("email",s.email),n.append("provider","google"),n.append("provider_id",s.sub);let{access_token:r,token_type:i,user:a}=(await f.A.post("".concat(d.B,"api/user/social/google/login"),n,{headers:{"Content-Type":"multipart/form-data"}})).data.data;p.A.set("access_token_login",r,{expires:1}),p.A.set("token_type_login",i),p.A.set("login_user_id",a.id.toString()),p.A.set("login_user_name",a.name),p.A.set("login_user_email",a.email),p.A.set("login_user_type",a.type.toString()),p.A.set("login_user_type_name",a.type_name||"user"),p.A.set("login_cart_count",(null===(t=a.CartCount)||void 0===t?void 0:t.toString())||"0"),a.pointsSettings&&(p.A.set("login_points",a.pointsSettings.points),p.A.set("login_price",a.pointsSettings.price),p.A.set("login_point_price",a.pointsSettings.point_price)),u.Ay.success("تم تسجيل الدخول بجوجل بنجاح \uD83C\uDF89"),window.location.href="/"}catch(t){console.error("Google login error:",t);let e=(null==t?void 0:null===(n=t.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"فشل تسجيل الدخول بجوجل";u.Ay.error(e)}},onError:()=>u.Ay.error("فشل تسجيل الدخول بجوجل")})})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm text-center mt-4",children:["لا تمتلك حسابًا؟"," ",(0,n.jsx)(c(),{href:"/register",className:"text-purple-700 hover:underline font-semibold text-center flex justify-center",children:"إنشاء حساب جديد"})]}),(0,n.jsx)(w,{show:s,onClose:()=>o(!1),setErrorModal:b}),y.show&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8 w-[90%] max-w-sm text-center",children:[(0,n.jsx)("div",{className:"mb-4 text-lg text-black",children:y.message||"هذا الايميل غير موجود!"}),(0,n.jsx)("button",{className:"text-purple-700 font-bold mt-2",onClick:()=>b({show:!1,message:""}),children:"تأكيد"})]})})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5037,7442,4897,7301,8441,1517,7358],()=>t(3414)),_N_E=e.O()}]);